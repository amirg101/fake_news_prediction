# -*- coding: utf-8 -*-
"""fakenewsdetection.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1e4yyAkpgu6rNgfiQtKcKPOClESuOo038
"""

# fake news detection project
import pandas as pd
import numpy as np
#Data Collection
data=pd.read_csv('/content/news.csv')

#Cleaning the data

data=data.drop(axis=1,labels="Unnamed: 0")

data=data.dropna()

data

data_S=data[:5000]

x=data_S.iloc[:,:-1].values
y=data_S.iloc[:,-1].values

x[0]

y[0]

from sklearn.feature_extraction.text import CountVectorizer
cv=CountVectorizer(max_features=5000)
mat_body=cv.fit_transform(x[:,1]).todense()

mat_body

cv_head=CountVectorizer(max_features=5000)
mat_head=cv_head.fit_transform(x[:,0]).todense()

mat_head
x_mat=np.hstack((mat_head,mat_body))

#splitting the dataset
from sklearn.model_selection import train_test_split as tts
x_train,x_test,y_train,y_test= tts(x_mat,y,test_size=0.2,random_state=10)

from sklearn.tree import DecisionTreeClassifier
dtc=DecisionTreeClassifier(criterion="entropy")
dtc.fit(x_train,y_train)
y_pred=dtc.predict(x_test)

from sklearn.metrics import confusion_matrix as cm
pred=cm(y_test,y_pred)

accuracy_pred=(pred[0][0]+pred[1][1])/(pred[0][0]+pred[1][1]+pred[0][1]+pred[1][0])

accuracy_pred

